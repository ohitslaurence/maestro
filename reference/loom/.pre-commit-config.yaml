# prek configuration (compatible with pre-commit)
# Install hooks with: prek install
# Run all hooks: prek run --all-files
# Run specific hook: prek run <hook-id>

default_stages: [pre-commit]

repos:
  - repo: local
    hooks:
      - id: block-backup-files
        name: Block backup files
        entry: scripts/hooks/block-backup-files.sh
        language: script
        types: [text]
        pass_filenames: false

      - id: block-secrets-backup
        name: Block secrets backup files
        entry: scripts/hooks/block-secrets-backup.sh
        language: script
        types: [text]
        pass_filenames: false

      - id: cargo2nix-update
        name: Update Cargo.nix
        entry: scripts/hooks/cargo2nix-update.sh
        language: script
        files: (^Cargo\.lock$|^crates/loom-server/migrations/)
        pass_filenames: false

      - id: i18n-coverage-web
        name: Check i18n translation coverage (web)
        entry: scripts/hooks/i18n-coverage-web.sh
        language: script
        files: ^web/loom-web/src/locales/en/messages\.po$
        pass_filenames: false

      - id: i18n-coverage-rust
        name: Check i18n translation coverage (rust)
        entry: scripts/hooks/i18n-coverage-rust.sh
        language: script
        files: ^crates/loom-common-i18n/locales/en/messages\.po$
        pass_filenames: false

      - id: loom-web-build
        name: Build loom-web
        entry: scripts/hooks/loom-web-build.sh
        language: script
        files: ^web/
        pass_filenames: false

      - id: shellcheck
        name: shellcheck
        entry: shellcheck
        language: system
        types: [shell]
